<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SHM: ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SHM
   </div>
   <div id="projectbrief">å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚’ç”¨ã„ãŸé«˜é€Ÿã§æ‰±ã„ã‚„ã™ã„ãƒ—ãƒ­ã‚»ã‚¹é–“é€šä¿¡ãƒãƒãƒ¼ã‚¸ãƒ£</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>[<a href="../md_manual_troubleshooting_en.html">English</a> | æ—¥æœ¬èª]</p>
<p>ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€å…±æœ‰ãƒ¡ãƒ¢ãƒªé€šä¿¡ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ˆãã‚ã‚‹å•é¡Œã¨ãã®è§£æ±ºæ–¹æ³•ã‚’è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚å•é¡ŒãŒç™ºç”Ÿã—ãŸæ™‚ã¯ã€è©²å½“ã™ã‚‹ç—‡çŠ¶ã‚’è¦‹ã¤ã‘ã¦é †ç•ªã«å¯¾å‡¦æ³•ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚</p>
<h1><a class="anchor" id="autotoc_md148"></a>
ğŸ“‹ ç›®æ¬¡</h1>
<ol type="1">
<li><a href="#ãƒ“ãƒ«ãƒ‰ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å•é¡Œ">ãƒ“ãƒ«ãƒ‰ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å•é¡Œ</a></li>
<li><a href="#å…±æœ‰ãƒ¡ãƒ¢ãƒªé€šä¿¡ã®å•é¡Œ">å…±æœ‰ãƒ¡ãƒ¢ãƒªé€šä¿¡ã®å•é¡Œ</a></li>
<li><a href="#serviceé€šä¿¡ã®å•é¡Œ">Serviceé€šä¿¡ã®å•é¡Œ</a></li>
<li><a href="#actioné€šä¿¡ã®å•é¡Œ">Actioné€šä¿¡ã®å•é¡Œ</a></li>
<li><a href="#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ</a></li>
<li><a href="#ç’°å¢ƒè¨­å®šå•é¡Œ">ç’°å¢ƒè¨­å®šå•é¡Œ</a></li>
<li><a href="#ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«">ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«</a></li>
</ol>
<h1><a class="anchor" id="autotoc_md149"></a>
ğŸ”¨ ãƒ“ãƒ«ãƒ‰ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å•é¡Œ</h1>
<h2><a class="anchor" id="autotoc_md150"></a>
âŒ ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„</h2>
<p><b>ç—‡çŠ¶</b>: </p><div class="fragment"><div class="line">fatal error: shm_pub_sub.hpp: No such file or directory</div>
<div class="line">fatal error: shm_service.hpp: No such file or directory</div>
<div class="line">fatal error: shm_action.hpp: No such file or directory</div>
</div><!-- fragment --><p><b>åŸå› ã¨å¯¾å‡¦æ³•</b>:</p>
<div class="fragment"><div class="line"># 1. ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ãƒ‘ã‚¹ã®ç¢ºèª</div>
<div class="line">ls include/</div>
<div class="line"># shm_pub_sub.hpp, udp_comm.hpp ãªã©ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèª</div>
<div class="line"> </div>
<div class="line"># 2. ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã®ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ãƒ‘ã‚¹æŒ‡å®š</div>
<div class="line">g++ -I./include your_program.cpp</div>
<div class="line"> </div>
<div class="line"># 3. CMakeLists.txtã§ã®è¨­å®š</div>
<div class="line">target_include_directories(your_target PRIVATE include)</div>
<div class="line"> </div>
<div class="line"># 4. å¿…è¦ãªãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª</div>
<div class="line">find /path/to/project -name &quot;*.hpp&quot; | grep shm</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md151"></a>
âŒ ãƒªãƒ³ã‚¯ã‚¨ãƒ©ãƒ¼</h2>
<p><b>ç—‡çŠ¶</b>: </p><div class="fragment"><div class="line">undefined reference to `irlab::shm::Publisher&lt;int&gt;::publish(int const&amp;)&#39;</div>
<div class="line">undefined reference to `irlab::shm::ServiceClient&lt;int,int&gt;::sendRequest(int const&amp;)&#39;</div>
<div class="line">undefined reference to `irlab::shm::ActionClient&lt;int,int,int&gt;::sendGoal(int const&amp;)&#39;</div>
</div><!-- fragment --><p><b>åŸå› ã¨å¯¾å‡¦æ³•</b>:</p>
<div class="fragment"><div class="line"># 1. ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª</div>
<div class="line">ls build/</div>
<div class="line"># libshm_pub_sub.so, libshm_service.so, libshm_action.so ãªã©ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèª</div>
<div class="line"> </div>
<div class="line"># 2. ãƒªãƒ³ã‚¯æ™‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæŒ‡å®š</div>
<div class="line">g++ your_program.cpp -L./build -lshm_pub_sub -lshm_service -lshm_action</div>
<div class="line"> </div>
<div class="line"># 3. å®Ÿè¡Œæ™‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ‘ã‚¹è¨­å®š</div>
<div class="line">export LD_LIBRARY_PATH=./build:$LD_LIBRARY_PATH</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md152"></a>
âŒ C++17ã‚¨ãƒ©ãƒ¼</h2>
<p><b>ç—‡çŠ¶</b>: </p><div class="fragment"><div class="line">error: &#39;std::is_standard_layout_v&#39; was not declared in this scope</div>
</div><!-- fragment --><p><b>å¯¾å‡¦æ³•</b>: </p><div class="fragment"><div class="line"># C++17å¯¾å¿œã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’ä½¿ç”¨</div>
<div class="line">g++ -std=c++17 your_program.cpp</div>
<div class="line"> </div>
<div class="line"># ã¾ãŸã¯CMakeã§</div>
<div class="line">set(CMAKE_CXX_STANDARD 17)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md153"></a>
ğŸ§  å…±æœ‰ãƒ¡ãƒ¢ãƒªé€šä¿¡ã®å•é¡Œ</h1>
<h2><a class="anchor" id="autotoc_md154"></a>
âŒ ãƒ‡ãƒ¼ã‚¿ãŒå—ä¿¡ã•ã‚Œãªã„ï¼ˆå…±æœ‰ãƒ¡ãƒ¢ãƒªï¼‰</h2>
<p><b>ç—‡çŠ¶</b>: <code>subscribe()</code>ã§<code>state</code>ãŒå¸¸ã«<code>false</code></p>
<p><b>è¨ºæ–­æ‰‹é †</b>:</p>
<div class="fragment"><div class="line"><span class="comment">// ãƒ‡ãƒãƒƒã‚°ç”¨ã®è¨ºæ–­ã‚³ãƒ¼ãƒ‰</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="shm__pub__sub_8hpp.html">shm_pub_sub.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> diagnose_shm_communication() {</div>
<div class="line">    <span class="keyword">using namespace </span>irlab::shm;</div>
<div class="line">    </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;=== å…±æœ‰ãƒ¡ãƒ¢ãƒªé€šä¿¡è¨ºæ–­ ===&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 1. é€ä¿¡å´ãƒ†ã‚¹ãƒˆ</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        Publisher&lt;int&gt; pub(<span class="stringliteral">&quot;debug_topic&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… Publisherä½œæˆæˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        pub.publish(42);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… ãƒ‡ãƒ¼ã‚¿é€ä¿¡æˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ Publisherå¤±æ•—: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 2. å—ä¿¡å´ãƒ†ã‚¹ãƒˆ</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        Subscriber&lt;int&gt; sub(<span class="stringliteral">&quot;debug_topic&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… Subscriberä½œæˆæˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">bool</span> state;</div>
<div class="line">        <span class="keywordtype">int</span> data = sub.subscribe(&amp;state);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;å—ä¿¡çµæœ: state=&quot;</span> &lt;&lt; state &lt;&lt; <span class="stringliteral">&quot;, data=&quot;</span> &lt;&lt; data &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (!state) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ ãƒ‡ãƒ¼ã‚¿ãŒç„¡åŠ¹ - ä»¥ä¸‹ã‚’ç¢ºèª:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;   - é€ä¿¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå‹•ä½œä¸­ã‹ï¼Ÿ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;   - ãƒˆãƒ”ãƒƒã‚¯åãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹ï¼Ÿ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ Subscriberå¤±æ•—: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="ashm__pub__sub_8hpp_html"><div class="ttname"><a href="shm__pub__sub_8hpp.html">shm_pub_sub.hpp</a></div><div class="ttdoc">å‡ºç‰ˆ/è³¼èª­ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹ãƒˆãƒ”ãƒƒã‚¯é€šä¿¡ã‚’è¦å®šã™ã‚‹ã‚¯ãƒ©ã‚¹ã®å®šç¾©</div></div>
</div><!-- fragment --><p><b>ã‚ˆãã‚ã‚‹åŸå› ã¨å¯¾å‡¦æ³•</b>:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">åŸå›    </th><th class="markdownTableHeadNone">å¯¾å‡¦æ³•    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>ãƒˆãƒ”ãƒƒã‚¯åã®ä¸ä¸€è‡´</b>   </td><td class="markdownTableBodyNone">é€ä¿¡å´ã¨å—ä¿¡å´ã§åŒã˜æ–‡å­—åˆ—ã‚’ä½¿ç”¨    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>ãƒ‡ãƒ¼ã‚¿å‹ã®ä¸ä¸€è‡´</b>   </td><td class="markdownTableBodyNone"><code>Publisher&lt;int&gt;</code>ã¨<code>Subscriber&lt;int&gt;</code>ã§å‹ã‚’çµ±ä¸€    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>é€ä¿¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå‹•ã„ã¦ã„ãªã„</b>   </td><td class="markdownTableBodyNone">é€ä¿¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å…ˆã«èµ·å‹•    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>æ¨©é™å•é¡Œ</b>   </td><td class="markdownTableBodyNone"><code>sudo</code>ã§ã®å®Ÿè¡Œã¾ãŸã¯æ¨©é™è¨­å®š   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md155"></a>
âŒ å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼</h2>
<p><b>ç—‡çŠ¶</b>: </p><div class="fragment"><div class="line">terminate called after throwing an instance of &#39;std::runtime_error&#39;</div>
<div class="line">what(): Failed to create shared memory</div>
</div><!-- fragment --><p><b>å¯¾å‡¦æ³•</b>:</p>
<div class="fragment"><div class="line"># 1. æ—¢å­˜ã®å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªãƒ»å‰Šé™¤</div>
<div class="line">ipcs -m</div>
<div class="line"># ä¸è¦ãªå…±æœ‰ãƒ¡ãƒ¢ãƒªã‚’å‰Šé™¤</div>
<div class="line">ipcrm -m [shmid]</div>
<div class="line"> </div>
<div class="line"># 2. æ¨©é™ã®ç¢ºèª</div>
<div class="line">ls -la /dev/shm/</div>
<div class="line"># shm_* ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ã‚’ç¢ºèª</div>
<div class="line"> </div>
<div class="line"># 3. æ¨©é™å¤‰æ›´ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰</div>
<div class="line">sudo chmod 666 /dev/shm/shm_*</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md156"></a>
ğŸ¤ Serviceé€šä¿¡ã®å•é¡Œ</h1>
<h2><a class="anchor" id="autotoc_md157"></a>
âŒ è¦æ±‚å¿œç­”ãŒã§ããªã„</h2>
<p><b>ç—‡çŠ¶</b>: Serviceé€šä¿¡ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¿œç­”ã‚’å—ã‘å–ã‚Œãªã„</p>
<p><b>è¨ºæ–­æ‰‹é †</b>:</p>
<div class="fragment"><div class="line"><span class="comment">// Serviceé€šä¿¡è¨ºæ–­ã‚³ãƒ¼ãƒ‰</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="shm__service_8hpp.html">shm_service.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> diagnose_service_communication() {</div>
<div class="line">    <span class="keyword">using namespace </span>irlab::shm;</div>
<div class="line">    </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;=== Serviceé€šä¿¡è¨ºæ–­ ===&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 1. ã‚µãƒ¼ãƒãƒ¼ãƒ†ã‚¹ãƒˆ</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        ServiceServer&lt;int, int&gt; server(<span class="stringliteral">&quot;debug_service&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… ServiceServerä½œæˆæˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// ãƒ†ã‚¹ãƒˆç”¨ã®ç°¡å˜ãªå‡¦ç†</span></div>
<div class="line">        <span class="keywordflow">if</span> (server.hasRequest()) {</div>
<div class="line">            <span class="keywordtype">int</span> request = server.getRequest();</div>
<div class="line">            server.sendResponse(request * 2);</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… ãƒ†ã‚¹ãƒˆè¦æ±‚å‡¦ç†æˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ ServiceServerå¤±æ•—: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;åŸå› ã®å¯èƒ½æ€§:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  - å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ä½œæˆå¤±æ•—&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  - ã‚µãƒ¼ãƒ“ã‚¹åã®é‡è¤‡&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 2. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        ServiceClient&lt;int, int&gt; client(<span class="stringliteral">&quot;debug_service&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… ServiceClientä½œæˆæˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// ãƒ†ã‚¹ãƒˆè¦æ±‚é€ä¿¡</span></div>
<div class="line">        client.sendRequest(21);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… è¦æ±‚é€ä¿¡æˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// å¿œç­”å¾…æ©Ÿ</span></div>
<div class="line">        <span class="keywordflow">if</span> (client.waitForResponse(1000000)) {  <span class="comment">// 1ç§’</span></div>
<div class="line">            <span class="keywordtype">int</span> response = client.getResponse();</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… Serviceé€šä¿¡æˆåŠŸ: 21 -&gt; &quot;</span> &lt;&lt; response &lt;&lt; std::endl;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ å¿œç­”ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;åŸå› ã®å¯èƒ½æ€§:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;  - ã‚µãƒ¼ãƒãƒ¼ãŒå‹•ä½œã—ã¦ã„ãªã„&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;  - ã‚µãƒ¼ãƒ“ã‚¹åã®ä¸ä¸€è‡´&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;  - ã‚µãƒ¼ãƒãƒ¼ã®å‡¦ç†ãŒé…ã„&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ ServiceClientå¤±æ•—: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="ashm__service_8hpp_html"><div class="ttname"><a href="shm__service_8hpp.html">shm_service.hpp</a></div><div class="ttdoc">ãƒ¡ãƒ¢ãƒªã®æ ¼ç´æ–¹æ³•ã‚’è¦å®šã™ã‚‹ã‚¯ãƒ©ã‚¹ã®å®šç¾©</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md158"></a>
âŒ Serviceã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå•é¡Œ</h2>
<p><b>ç—‡çŠ¶</b>: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¿œç­”ã‚’å¾…ã¤é–“ã«ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã™ã‚‹</p>
<p><b>å¯¾å‡¦æ³•</b>:</p>
<div class="fragment"><div class="line"><span class="comment">// ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã®èª¿æ•´</span></div>
<div class="line">ServiceClient&lt;int, int&gt; client(<span class="stringliteral">&quot;slow_service&quot;</span>);</div>
<div class="line">client.sendRequest(request_data);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1ç§’ (1,000,000ãƒã‚¤ã‚¯ãƒ­ç§’)</span></div>
<div class="line"><span class="comment">// é•·æ™‚é–“å‡¦ç†ç”¨: 10ç§’</span></div>
<div class="line"><span class="keywordflow">if</span> (client.waitForResponse(10000000)) {  <span class="comment">// 10ç§’</span></div>
<div class="line">    <span class="keyword">auto</span> response = client.getResponse();</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;å¿œç­”å—ä¿¡: &quot;</span> &lt;&lt; response &lt;&lt; std::endl;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;ã‚µãƒ¼ãƒ“ã‚¹å‡¦ç†ãŒé…ã„ã§ã™&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ãƒã‚§ãƒƒã‚¯</span></div>
<div class="line"><span class="keywordflow">if</span> (client.hasResponse()) {</div>
<div class="line">    <span class="keyword">auto</span> response = client.getResponse();</div>
<div class="line">    <span class="comment">// å¿œç­”ã‚ã‚Š</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// ã¾ã å‡¦ç†ä¸­</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md159"></a>
âŒ ã‚µãƒ¼ãƒ“ã‚¹åã®é‡è¤‡</h2>
<p><b>ç—‡çŠ¶</b>: åŒã˜ã‚µãƒ¼ãƒ“ã‚¹åã§è¤‡æ•°ã®ã‚µãƒ¼ãƒãƒ¼ãŒå‹•ä½œã—ã¦ã„ã‚‹</p>
<p><b>è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰</b>:</p>
<div class="fragment"><div class="line"># å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ç¢ºèª</div>
<div class="line">ipcs -m | grep shm_service</div>
<div class="line"> </div>
<div class="line"># ãƒ—ãƒ­ã‚»ã‚¹ã®ç¢ºèª</div>
<div class="line">ps aux | grep service</div>
<div class="line"> </div>
<div class="line"># é‡è¤‡ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã®æ•´ç†</div>
<div class="line">ipcrm -m [shmid]  # ä¸è¦ãªã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md160"></a>
âš¡ Actioné€šä¿¡ã®å•é¡Œ</h1>
<h2><a class="anchor" id="autotoc_md161"></a>
âŒ ActionãŒé–‹å§‹ã•ã‚Œãªã„</h2>
<p><b>ç—‡çŠ¶</b>: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚´ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¦ã‚‚ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒé–‹å§‹ã•ã‚Œãªã„</p>
<p><b>è¨ºæ–­ã‚³ãƒ¼ãƒ‰</b>:</p>
<div class="fragment"><div class="line"><span class="comment">// Actioné€šä¿¡è¨ºæ–­ã‚³ãƒ¼ãƒ‰</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="shm__action_8hpp.html">shm_action.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> diagnose_action_communication() {</div>
<div class="line">    <span class="keyword">using namespace </span>irlab::shm;</div>
<div class="line">    </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;=== Actioné€šä¿¡è¨ºæ–­ ===&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 1. ã‚µãƒ¼ãƒãƒ¼ãƒ†ã‚¹ãƒˆ</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        ActionServer&lt;int, int, int&gt; server(<span class="stringliteral">&quot;debug_action&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… ActionServerä½œæˆæˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (server.hasGoal()) {</div>
<div class="line">            <span class="keyword">auto</span> goal = server.getGoal();</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… ã‚´ãƒ¼ãƒ«å—ä¿¡: &quot;</span> &lt;&lt; goal &lt;&lt; std::endl;</div>
<div class="line">            </div>
<div class="line">            <span class="comment">// ç°¡å˜ãªå‡¦ç†ã‚’å®Ÿè¡Œ</span></div>
<div class="line">            server.setSucceeded(goal * 2);</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… Actionå®Œäº†&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ ã‚´ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ ActionServerå¤±æ•—: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 2. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ†ã‚¹ãƒˆ</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        ActionClient&lt;int, int, int&gt; client(<span class="stringliteral">&quot;debug_action&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… ActionClientä½œæˆæˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        client.sendGoal(42);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… ã‚´ãƒ¼ãƒ«é€ä¿¡æˆåŠŸ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// çŠ¶æ…‹ç¢ºèª</span></div>
<div class="line">        <span class="keywordflow">if</span> (client.waitForResult(5000000)) {  <span class="comment">// 5ç§’</span></div>
<div class="line">            <span class="keyword">auto</span> result = client.getResult();</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âœ… Actionçµæœå—ä¿¡: &quot;</span> &lt;&lt; result &lt;&lt; std::endl;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ Actionã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;âŒ ActionClientå¤±æ•—: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="ashm__action_8hpp_html"><div class="ttname"><a href="shm__action_8hpp.html">shm_action.hpp</a></div><div class="ttdoc">ãƒ¡ãƒ¢ãƒªã®æ ¼ç´æ–¹æ³•ã‚’è¦å®šã™ã‚‹ã‚¯ãƒ©ã‚¹ã®å®šç¾©</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md162"></a>
âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ</h1>
<h2><a class="anchor" id="autotoc_md163"></a>
âŒ é€šä¿¡ãŒé…ã„</h2>
<p><b>ç—‡çŠ¶</b>: æœŸå¾…ã‚ˆã‚Šé€šä¿¡é€Ÿåº¦ãŒé…ã„</p>
<p><b>è¨ºæ–­ã¨å¯¾å‡¦æ³•</b>:</p>
<div class="fragment"><div class="line"><span class="comment">// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šã‚³ãƒ¼ãƒ‰</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> measure_performance() {</div>
<div class="line">    <span class="keyword">using namespace </span>std::chrono;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// å…±æœ‰ãƒ¡ãƒ¢ãƒªæ€§èƒ½æ¸¬å®š</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">using namespace </span>irlab::shm;</div>
<div class="line">        Publisher&lt;int&gt; pub(<span class="stringliteral">&quot;perf_test&quot;</span>);</div>
<div class="line">        Subscriber&lt;int&gt; sub(<span class="stringliteral">&quot;perf_test&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> iterations = 10000;</div>
<div class="line">        <span class="keyword">auto</span> start = high_resolution_clock::now();</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iterations; ++i) {</div>
<div class="line">            pub.publish(i);</div>
<div class="line">            <span class="keywordtype">bool</span> state;</div>
<div class="line">            sub.subscribe(&amp;state);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">auto</span> end = high_resolution_clock::now();</div>
<div class="line">        <span class="keyword">auto</span> duration = duration_cast&lt;microseconds&gt;(end - start);</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;å…±æœ‰ãƒ¡ãƒ¢ãƒªé€šä¿¡:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  ç·æ™‚é–“: &quot;</span> &lt;&lt; duration.count() &lt;&lt; <span class="stringliteral">&quot; Î¼s&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  1å›ã‚ãŸã‚Š: &quot;</span> &lt;&lt; duration.count() / iterations &lt;&lt; <span class="stringliteral">&quot; Î¼s&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// UDPæ€§èƒ½æ¸¬å®š</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">using namespace </span>irlab::udp;</div>
<div class="line">        Sender&lt;int&gt; sender(<span class="stringliteral">&quot;perf_test&quot;</span>);</div>
<div class="line">        Receiver&lt;int&gt; receiver(<span class="stringliteral">&quot;perf_test&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> iterations = 1000;  <span class="comment">// UDPã¯å°‘ãªã‚</span></div>
<div class="line">        <span class="keyword">auto</span> start = high_resolution_clock::now();</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iterations; ++i) {</div>
<div class="line">            sender.send(i);</div>
<div class="line">            receiver.waitFor(10000);  <span class="comment">// 10mså¾…æ©Ÿ</span></div>
<div class="line">            <span class="keywordtype">bool</span> state;</div>
<div class="line">            receiver.receive(&amp;state);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">auto</span> end = high_resolution_clock::now();</div>
<div class="line">        <span class="keyword">auto</span> duration = duration_cast&lt;milliseconds&gt;(end - start);</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;UDPé€šä¿¡:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  ç·æ™‚é–“: &quot;</span> &lt;&lt; duration.count() &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;  1å›ã‚ãŸã‚Š: &quot;</span> &lt;&lt; duration.count() / (double)iterations &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„æ–¹æ³•</b>:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">é€šä¿¡æ–¹å¼   </th><th class="markdownTableHeadNone">æ”¹å–„æ–¹æ³•    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>å…±æœ‰ãƒ¡ãƒ¢ãƒª</b>   </td><td class="markdownTableBodyNone">ãƒ»CPUã‚¢ãƒ•ã‚£ãƒ‹ãƒ†ã‚£è¨­å®š<br  />
ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ã‚»ã‚¹å„ªå…ˆåº¦<br  />
ãƒ»ä¸è¦ãªã‚·ã‚¹ãƒ†ãƒ è² è·å‰Šæ¸›    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>UDP</b>   </td><td class="markdownTableBodyNone">ãƒ»é€ä¿¡é–“éš”ã®èª¿æ•´<br  />
ãƒ»ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºæœ€é©åŒ–<br  />
ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šç¢ºèª   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md164"></a>
ğŸ”§ ç’°å¢ƒè¨­å®šå•é¡Œ</h1>
<h2><a class="anchor" id="autotoc_md165"></a>
âŒ æ¨©é™ã‚¨ãƒ©ãƒ¼</h2>
<p><b>ç—‡çŠ¶</b>: </p><div class="fragment"><div class="line">Permission denied</div>
<div class="line">Failed to create shared memory segment</div>
</div><!-- fragment --><p><b>å¯¾å‡¦æ³•</b>:</p>
<div class="fragment"><div class="line"># 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’shmå¯èƒ½ã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ </div>
<div class="line">sudo usermod -a -G audio $USER  # ã¾ãŸã¯é©åˆ‡ãªã‚°ãƒ«ãƒ¼ãƒ—</div>
<div class="line"> </div>
<div class="line"># 2. ä¸€æ™‚çš„ãªæ¨©é™å¤‰æ›´</div>
<div class="line">sudo chmod 777 /dev/shm</div>
<div class="line"> </div>
<div class="line"># 3. systemdè¨­å®šï¼ˆæ°¸ç¶šçš„ï¼‰</div>
<div class="line"># /etc/systemd/system.conf ã«è¿½åŠ </div>
<div class="line">DefaultLimitMEMLOCK=infinity</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md166"></a>
âŒ ä¾å­˜é–¢ä¿‚å•é¡Œ</h2>
<p><b>ç—‡çŠ¶</b>: å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒè¦‹ã¤ã‹ã‚‰ãªã„</p>
<p><b>å¯¾å‡¦æ³•</b>:</p>
<div class="fragment"><div class="line"># Ubuntu/Debian</div>
<div class="line">sudo apt update</div>
<div class="line">sudo apt install build-essential cmake libboost-all-dev python3-dev</div>
<div class="line"> </div>
<div class="line"># CentOS/RHEL</div>
<div class="line">sudo yum groupinstall &quot;Development Tools&quot;</div>
<div class="line">sudo yum install cmake boost-devel python3-devel</div>
<div class="line"> </div>
<div class="line"># ä¾å­˜é–¢ä¿‚ç¢ºèª</div>
<div class="line">ldd your_program</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md167"></a>
ğŸ” ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«</h1>
<h2><a class="anchor" id="autotoc_md168"></a>
å…±æœ‰ãƒ¡ãƒ¢ãƒªç›£è¦–ãƒ„ãƒ¼ãƒ«</h2>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line"># shm_monitor.sh - å…±æœ‰ãƒ¡ãƒ¢ãƒªç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</div>
<div class="line"> </div>
<div class="line">echo &quot;=== å…±æœ‰ãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³ ===&quot;</div>
<div class="line">echo &quot;ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“:&quot;</div>
<div class="line">ipcs -m</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;SHMãƒ©ã‚¤ãƒ–ãƒ©ãƒªé–¢é€£:&quot;</div>
<div class="line">ls -la /dev/shm/ | grep shm_</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–:&quot;</div>
<div class="line">ps aux | grep -E &quot;(your_program_name|shm)&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md169"></a>
Service/ActionçŠ¶æ…‹è¨ºæ–­ãƒ„ãƒ¼ãƒ«</h2>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line"># service_action_debug.sh - Service/Actioné€šä¿¡è¨ºæ–­ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</div>
<div class="line"> </div>
<div class="line">SERVICE_NAME=${1:-&quot;test_service&quot;}</div>
<div class="line"> </div>
<div class="line">echo &quot;=== Service/Actioné€šä¿¡è¨ºæ–­ (Service: $SERVICE_NAME) ===&quot;</div>
<div class="line"> </div>
<div class="line">echo &quot;1. å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚»ã‚°ãƒ¡ãƒ³ãƒˆ:&quot;</div>
<div class="line">ipcs -m | grep -E &quot;(shm_service|shm_action)&quot; || echo &quot;ã‚µãƒ¼ãƒ“ã‚¹é–¢é€£ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“&quot;</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;2. é–¢é€£ãƒ—ãƒ­ã‚»ã‚¹:&quot;</div>
<div class="line">ps aux | grep -E &quot;(service|action)&quot; | grep -v grep || echo &quot;é–¢é€£ãƒ—ãƒ­ã‚»ã‚¹ã¯ã‚ã‚Šã¾ã›ã‚“&quot;</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;3. ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡:&quot;</div>
<div class="line">free -h</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;4. ã‚·ã‚¹ãƒ†ãƒ ãƒ­ãƒ¼ãƒ‰:&quot;</div>
<div class="line">uptime</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;5. ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ã‚¨ãƒ©ãƒ¼:&quot;</div>
<div class="line">dmesg | tail -10 | grep -i error || echo &quot;æœ€è¿‘ã®ã‚¨ãƒ©ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md170"></a>
ãƒ­ã‚°å‡ºåŠ›è¨­å®š</h2>
<div class="fragment"><div class="line"><span class="comment">// debug_logger.hpp - ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ­ã‚°æ©Ÿèƒ½</span></div>
<div class="line"><span class="preprocessor">#ifndef DEBUG_LOGGER_HPP</span></div>
<div class="line"><span class="preprocessor">#define DEBUG_LOGGER_HPP</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>DebugLogger {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> DebugLogger&amp; getInstance() {</div>
<div class="line">        <span class="keyword">static</span> DebugLogger instance;</div>
<div class="line">        <span class="keywordflow">return</span> instance;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span>... Args&gt;</div>
<div class="line">    <span class="keywordtype">void</span> log(Args&amp;&amp;... args) {</div>
<div class="line">        <span class="keyword">auto</span> now = std::chrono::system_clock::now();</div>
<div class="line">        <span class="keyword">auto</span> time_t = std::chrono::system_clock::to_time_t(now);</div>
<div class="line">        </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; std::put_time(std::localtime(&amp;time_t), <span class="stringliteral">&quot;%Y-%m-%d %H:%M:%S&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line">        (std::cout &lt;&lt; ... &lt;&lt; args) &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (log_file_.is_open()) {</div>
<div class="line">            log_file_ &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; std::put_time(std::localtime(&amp;time_t), <span class="stringliteral">&quot;%Y-%m-%d %H:%M:%S&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line">            (log_file_ &lt;&lt; ... &lt;&lt; args) &lt;&lt; std::endl;</div>
<div class="line">            log_file_.flush();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> enableFileLogging(<span class="keyword">const</span> std::string&amp; filename) {</div>
<div class="line">        log_file_.open(filename, std::ios::app);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::ofstream log_file_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define DEBUG_LOG(...) DebugLogger::getInstance().log(__VA_ARGS__)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md171"></a>
ğŸ“ ã‚µãƒãƒ¼ãƒˆãŒå¿…è¦ãªå ´åˆ</h1>
<h2><a class="anchor" id="autotoc_md172"></a>
æƒ…å ±åé›†</h2>
<p>å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’åé›†ã—ã¦ã‚µãƒãƒ¼ãƒˆãƒãƒ¼ãƒ ã«ãŠçŸ¥ã‚‰ã›ãã ã•ã„ï¼š</p>
<div class="fragment"><div class="line"># ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±åé›†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</div>
<div class="line">#!/bin/bash</div>
<div class="line"># collect_info.sh</div>
<div class="line"> </div>
<div class="line">echo &quot;=== ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± ===&quot;</div>
<div class="line">uname -a</div>
<div class="line">lsb_release -a 2&gt;/dev/null || cat /etc/os-release</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;=== ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©æƒ…å ± ===&quot;</div>
<div class="line">g++ --version</div>
<div class="line">cmake --version</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;=== ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæƒ…å ± ===&quot;</div>
<div class="line">find . -name &quot;*.so&quot; -exec ls -la {} \;</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;=== å…±æœ‰ãƒ¡ãƒ¢ãƒªçŠ¶æ³ ===&quot;</div>
<div class="line">ipcs -m</div>
<div class="line">ls -la /dev/shm/ | grep shm_</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;=== ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ ===&quot;</div>
<div class="line">free -h</div>
<div class="line">df -h /dev/shm</div>
<div class="line"> </div>
<div class="line">echo &quot;&quot;</div>
<div class="line">echo &quot;=== é–¢é€£ãƒ—ãƒ­ã‚»ã‚¹çŠ¶æ³ ===&quot;</div>
<div class="line">ps aux | grep -E &quot;(your_program|shm|service|action)&quot; | grep -v grep</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md173"></a>
ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆå½¢å¼</h2>
<div class="fragment"><div class="line">ã€å•é¡Œã®ç—‡çŠ¶ã€‘</div>
<div class="line">ãƒ»ã©ã®ã‚ˆã†ãªå‹•ä½œã‚’æœŸå¾…ã—ã¦ã„ãŸã‹</div>
<div class="line">ãƒ»å®Ÿéš›ã«ã¯ã©ã†ãªã£ãŸã‹</div>
<div class="line">ãƒ»ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆã‚ã‚Œã°ï¼‰</div>
<div class="line"> </div>
<div class="line">ã€ç’°å¢ƒæƒ…å ±ã€‘</div>
<div class="line">ãƒ»OS: Ubuntu 20.04</div>
<div class="line">ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©: g++ 9.4.0</div>
<div class="line">ãƒ»ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª: shm_pub_sub, shm_service, shm_action v1.0</div>
<div class="line"> </div>
<div class="line">ã€å†ç¾æ‰‹é †ã€‘</div>
<div class="line">1. ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</div>
<div class="line">2. é€ä¿¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œ</div>
<div class="line">3. å—ä¿¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œ</div>
<div class="line">4. â†’ ãƒ‡ãƒ¼ã‚¿ãŒå—ä¿¡ã•ã‚Œãªã„</div>
<div class="line"> </div>
<div class="line">ã€è©¦ã—ãŸã“ã¨ã€‘</div>
<div class="line">ãƒ»å…±æœ‰ãƒ¡ãƒ¢ãƒªã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ç¢ºèª (ipcs -m)</div>
<div class="line">ãƒ»ãƒˆãƒ”ãƒƒã‚¯å/ã‚µãƒ¼ãƒ“ã‚¹åã®ç¢ºèª</div>
<div class="line">ãƒ»ãƒ—ãƒ­ã‚»ã‚¹ã®èµ·å‹•é †åºç¢ºèª</div>
<div class="line">ãƒ»...</div>
</div><!-- fragment --><hr  />
<p>ã“ã®ã‚¬ã‚¤ãƒ‰ã§å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€é æ…®ãªãã‚µãƒãƒ¼ãƒˆãƒãƒ¼ãƒ ã¾ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ï¼ ğŸš€ </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jul 6 2025 14:47:59 for SHM by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
