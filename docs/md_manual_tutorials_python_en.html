<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SHM: 🐍 Python Tutorials - Master Inter-Process Communication with Python</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SHM
   </div>
   <div id="projectbrief">Shared-memory based Handy-communication Manager</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">🐍 Python Tutorials - Master Inter-Process Communication with Python </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>[English | <a href="docs_jp/md_manual_tutorials_python_jp.html">日本語</a>]</p>
<h1><a class="anchor" id="autotoc_md220"></a>
🌟 Overview</h1>
<p>The Shared Memory Based Handy Communication Manager (SHM) is a library that provides high-speed inter-process communication using shared memory. This library enables topic-based communication using the Publisher/Subscriber model with seamless Python integration.</p>
<h1><a class="anchor" id="autotoc_md221"></a>
✨ Key Features</h1>
<ul>
<li><b>⚡ High-Speed Communication</b>: Achieves low-latency and high-throughput communication using shared memory</li>
<li><b>🔄 Ring Buffer Architecture</b>: Utilizes multiple buffers to minimize read/write conflicts</li>
<li><b>🛡️ Type Safety</b>: Provides type-safe communication through template-based design</li>
<li><b>🐍 Python Support</b>: Full Python bindings using Boost.Python for seamless C++/Python integration</li>
</ul>
<h1><a class="anchor" id="autotoc_md222"></a>
📊 Supported Data Types</h1>
<p>The library currently supports the following data types:</p>
<ul>
<li><code>bool</code> - Boolean values</li>
<li><code>int</code> - Integer values <br  />
</li>
<li><code>float</code> - Floating-point values</li>
</ul>
<h1><a class="anchor" id="autotoc_md223"></a>
🔧 Python API Reference</h1>
<h2><a class="anchor" id="autotoc_md224"></a>
📤 Publisher (Data Sender)</h2>
<p>The Publisher class writes data to shared memory for broadcast communication.</p>
<h3><a class="anchor" id="autotoc_md225"></a>
Constructor</h3>
<div class="fragment"><div class="line"># Boolean Publisher</div>
<div class="line">pub_bool = shm_pub_sub.Publisher(name: str, default_value: bool, buffer_num: int)</div>
<div class="line"> </div>
<div class="line"># Integer Publisher  </div>
<div class="line">pub_int = shm_pub_sub.Publisher(name: str, default_value: int, buffer_num: int)</div>
<div class="line"> </div>
<div class="line"># Float Publisher</div>
<div class="line">pub_float = shm_pub_sub.Publisher(name: str, default_value: float, buffer_num: int)</div>
</div><!-- fragment --><p><b>Parameters:</b></p><ul>
<li><code>name</code>: Shared memory name (string identifier)</li>
<li><code>default_value</code>: Default value (bool/int/float depending on type)</li>
<li><code>buffer_num</code>: Number of buffers (default: 3)</li>
</ul>
<h3><a class="anchor" id="autotoc_md226"></a>
Methods</h3>
<h4>publish(data)</h4>
<p>Writes data to shared memory for immediate broadcast to all subscribers.</p>
<div class="fragment"><div class="line"># Boolean data publishing</div>
<div class="line">pub_bool.publish(True)</div>
<div class="line"> </div>
<div class="line"># Integer data publishing  </div>
<div class="line">pub_int.publish(42)</div>
<div class="line"> </div>
<div class="line"># Float data publishing</div>
<div class="line">pub_float.publish(3.14159)</div>
</div><!-- fragment --><p><b>Example: Sensor Data Publisher</b> </p><div class="fragment"><div class="line">import shm_pub_sub</div>
<div class="line">import time</div>
<div class="line">import random</div>
<div class="line"> </div>
<div class="line"># Create temperature sensor publisher</div>
<div class="line">temp_pub = shm_pub_sub.Publisher(&quot;temperature_sensor&quot;, 0.0, 5)</div>
<div class="line"> </div>
<div class="line"># Publish sensor readings</div>
<div class="line">for i in range(100):</div>
<div class="line">    temperature = 20.0 + random.uniform(-5.0, 15.0)</div>
<div class="line">    temp_pub.publish(temperature)</div>
<div class="line">    print(f&quot;Published temperature: {temperature:.2f}°C&quot;)</div>
<div class="line">    time.sleep(0.1)  # 10Hz publishing rate</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md227"></a>
📥 Subscriber (Data Receiver)</h2>
<p>The Subscriber class reads data from shared memory published by Publishers.</p>
<h3><a class="anchor" id="autotoc_md228"></a>
Constructor</h3>
<div class="fragment"><div class="line"># Boolean Subscriber</div>
<div class="line">sub_bool = shm_pub_sub.Subscriber(name: str, default_value: bool)</div>
<div class="line"> </div>
<div class="line"># Integer Subscriber</div>
<div class="line">sub_int = shm_pub_sub.Subscriber(name: str, default_value: int)</div>
<div class="line"> </div>
<div class="line"># Float Subscriber  </div>
<div class="line">sub_float = shm_pub_sub.Subscriber(name: str, default_value: float)</div>
</div><!-- fragment --><p><b>Parameters:</b></p><ul>
<li><code>name</code>: Shared memory name (string identifier, must match Publisher)</li>
<li><code>default_value</code>: Default value (bool/int/float depending on type)</li>
</ul>
<h3><a class="anchor" id="autotoc_md229"></a>
Methods</h3>
<h4>subscribe()</h4>
<p>Reads data from shared memory with success indication.</p>
<div class="fragment"><div class="line"># Boolean data subscription</div>
<div class="line">data, is_success = sub_bool.subscribe()</div>
<div class="line"> </div>
<div class="line"># Integer data subscription</div>
<div class="line">data, is_success = sub_int.subscribe()</div>
<div class="line"> </div>
<div class="line"># Float data subscription</div>
<div class="line">data, is_success = sub_float.subscribe()</div>
</div><!-- fragment --><p><b>Return Values:</b></p><ul>
<li><code>data</code>: Retrieved data (bool/int/float)</li>
<li><code>is_success</code>: Success flag (bool) - True if new data was available</li>
</ul>
<p><b>Example: Multi-Subscriber System</b> </p><div class="fragment"><div class="line">import shm_pub_sub</div>
<div class="line">import time</div>
<div class="line">import threading</div>
<div class="line"> </div>
<div class="line">def temperature_monitor():</div>
<div class="line">    &quot;&quot;&quot;Monitor temperature and alert on extremes&quot;&quot;&quot;</div>
<div class="line">    temp_sub = shm_pub_sub.Subscriber(&quot;temperature_sensor&quot;, 0.0)</div>
<div class="line">    </div>
<div class="line">    while True:</div>
<div class="line">        temp, success = temp_sub.subscribe()</div>
<div class="line">        if success:</div>
<div class="line">            if temp &gt; 30.0:</div>
<div class="line">                print(f&quot;🔥 HIGH TEMPERATURE ALERT: {temp:.2f}°C&quot;)</div>
<div class="line">            elif temp &lt; 10.0:</div>
<div class="line">                print(f&quot;🧊 LOW TEMPERATURE ALERT: {temp:.2f}°C&quot;)</div>
<div class="line">        time.sleep(0.05)</div>
<div class="line"> </div>
<div class="line">def data_logger():</div>
<div class="line">    &quot;&quot;&quot;Log all temperature readings&quot;&quot;&quot;</div>
<div class="line">    temp_sub = shm_pub_sub.Subscriber(&quot;temperature_sensor&quot;, 0.0)</div>
<div class="line">    </div>
<div class="line">    while True:</div>
<div class="line">        temp, success = temp_sub.subscribe()</div>
<div class="line">        if success:</div>
<div class="line">            timestamp = time.time()</div>
<div class="line">            print(f&quot;📊 LOG: [{timestamp:.3f}] Temperature: {temp:.2f}°C&quot;)</div>
<div class="line">        time.sleep(0.1)</div>
<div class="line"> </div>
<div class="line"># Start monitoring threads</div>
<div class="line">monitor_thread = threading.Thread(target=temperature_monitor)</div>
<div class="line">logger_thread = threading.Thread(target=data_logger)</div>
<div class="line"> </div>
<div class="line">monitor_thread.start()</div>
<div class="line">logger_thread.start()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md230"></a>
🏗️ Build and Installation</h1>
<h2><a class="anchor" id="autotoc_md231"></a>
📋 Prerequisites</h2>
<ul>
<li><b>CMake</b> - Build system</li>
<li><b>Boost.Python</b> - Python bindings library</li>
<li><b>Python 3.6+</b> - Python interpreter</li>
<li><b>C++ Compiler</b> - GCC 7.0+ or equivalent</li>
</ul>
<h2><a class="anchor" id="autotoc_md232"></a>
🔨 Build Instructions</h2>
<div class="fragment"><div class="line"># Navigate to the CMake directory</div>
<div class="line">cd shm_ws/src/shared-memory-based-handy-communication-manager</div>
<div class="line"> </div>
<div class="line"># Create build directory</div>
<div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line"> </div>
<div class="line"># Run CMake configuration</div>
<div class="line">cmake ..</div>
<div class="line"> </div>
<div class="line"># Build the project</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># Install Python package</div>
<div class="line">cd ../shm_pub_sub/scripts</div>
<div class="line">python setup.py install</div>
</div><!-- fragment --><p><b>Alternative Installation (Development Mode):</b> </p><div class="fragment"><div class="line"># Install in development mode for easier debugging</div>
<div class="line">python setup.py develop</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md233"></a>
🚨 Limitations and Considerations</h1>
<h2><a class="anchor" id="autotoc_md234"></a>
Current Limitations</h2>
<ol type="1">
<li><b>POD Classes Only</b>: Currently supports Plain Old Data (POD) classes only</li>
<li><b>Fixed Size Data</b>: Variable-length data transmission is not supported</li>
<li><b>Inter-Process Communication</b>: Supports communication between processes on the same machine only</li>
<li><b>Data Types</b>: Limited to bool, int, and float types</li>
</ol>
<h2><a class="anchor" id="autotoc_md235"></a>
Future Enhancements</h2>
<ul>
<li>Support for custom data structures</li>
<li>Cross-network communication capabilities</li>
<li>Additional primitive data types</li>
<li>Enhanced error reporting</li>
</ul>
<h1><a class="anchor" id="autotoc_md236"></a>
🛠️ Error Handling</h1>
<h2><a class="anchor" id="autotoc_md237"></a>
Common Errors and Solutions</h2>
<h3><a class="anchor" id="autotoc_md238"></a>
1. Shared Memory Creation Failure</h3>
<div class="fragment"><div class="line"># Error symptoms</div>
<div class="line">RuntimeError: Failed to create shared memory</div>
<div class="line"> </div>
<div class="line"># Common causes and solutions</div>
<div class="line">- **Insufficient permissions**: Run with appropriate privileges</div>
<div class="line">- **Memory shortage**: Check system memory availability</div>
<div class="line">- **Name conflicts**: Use unique topic names</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md239"></a>
2. Data Reading Failure</h3>
<div class="fragment"><div class="line"># Error symptoms</div>
<div class="line">data, success = subscriber.subscribe()  # success = False</div>
<div class="line"> </div>
<div class="line"># Common causes and solutions</div>
<div class="line">- **No publisher**: Ensure publisher is running and publishing data</div>
<div class="line">- **Timing issues**: Publisher may not have sent data yet</div>
<div class="line">- **Topic name mismatch**: Verify exact topic name matching</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md240"></a>
3. Name Conflicts</h3>
<div class="fragment"><div class="line"># Error symptoms</div>
<div class="line">RuntimeError: Shared memory already exists</div>
<div class="line"> </div>
<div class="line"># Solutions</div>
<div class="line">- **Use unique names**: Employ descriptive, unique topic names</div>
<div class="line">- **Clean up resources**: Remove existing shared memory segments</div>
<div class="line">- **Check running processes**: Verify no duplicate publishers exist</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md241"></a>
📈 Performance Optimization</h1>
<h2><a class="anchor" id="autotoc_md242"></a>
Recommended Settings</h2>
<ul>
<li><b>Buffer Count</b>: 3-5 buffers (default: 3)<ul>
<li>More buffers = better handling of burst traffic</li>
<li>Fewer buffers = lower memory usage</li>
</ul>
</li>
<li><b>Publishing Frequency</b>: Adjust based on application needs</li>
<li><b>Data Size</b>: Optimal for small data (tens of bytes)</li>
</ul>
<h2><a class="anchor" id="autotoc_md243"></a>
Performance Benchmarks</h2>
<p>Typical performance characteristics (reference values):</p>
<ul>
<li><b>Latency</b>: Several microseconds</li>
<li><b>Throughput</b>: Hundreds of thousands of messages/second</li>
<li><b>Memory Usage</b>: Data size × Buffer count × Number of topics</li>
</ul>
<p><b>Example: Performance Testing</b> </p><div class="fragment"><div class="line">import shm_pub_sub</div>
<div class="line">import time</div>
<div class="line"> </div>
<div class="line">def benchmark_publish_subscribe():</div>
<div class="line">    &quot;&quot;&quot;Benchmark publish/subscribe performance&quot;&quot;&quot;</div>
<div class="line">    pub = shm_pub_sub.Publisher(&quot;benchmark&quot;, 0, 10)</div>
<div class="line">    sub = shm_pub_sub.Subscriber(&quot;benchmark&quot;, 0)</div>
<div class="line">    </div>
<div class="line">    # Warm up</div>
<div class="line">    for i in range(100):</div>
<div class="line">        pub.publish(i)</div>
<div class="line">        data, success = sub.subscribe()</div>
<div class="line">    </div>
<div class="line">    # Benchmark</div>
<div class="line">    start_time = time.time()</div>
<div class="line">    messages_sent = 10000</div>
<div class="line">    </div>
<div class="line">    for i in range(messages_sent):</div>
<div class="line">        pub.publish(i)</div>
<div class="line">    </div>
<div class="line">    # Measure receive performance</div>
<div class="line">    received_count = 0</div>
<div class="line">    while received_count &lt; messages_sent:</div>
<div class="line">        data, success = sub.subscribe()</div>
<div class="line">        if success:</div>
<div class="line">            received_count += 1</div>
<div class="line">    </div>
<div class="line">    end_time = time.time()</div>
<div class="line">    duration = end_time - start_time</div>
<div class="line">    </div>
<div class="line">    print(f&quot;📊 Performance Results:&quot;)</div>
<div class="line">    print(f&quot;   Messages: {messages_sent}&quot;)</div>
<div class="line">    print(f&quot;   Duration: {duration:.3f} seconds&quot;)</div>
<div class="line">    print(f&quot;   Throughput: {messages_sent/duration:.0f} messages/second&quot;)</div>
<div class="line">    print(f&quot;   Average latency: {duration/messages_sent*1000:.3f} ms&quot;)</div>
<div class="line"> </div>
<div class="line">benchmark_publish_subscribe()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md244"></a>
🔍 Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md245"></a>
Common Issues</h2>
<h3><a class="anchor" id="autotoc_md246"></a>
1. Python Module Not Found</h3>
<div class="fragment"><div class="line">ImportError: No module named &#39;shm_pub_sub&#39;</div>
</div><!-- fragment --><p> <b>Solution:</b></p><ul>
<li>Verify setup.py installation was successful</li>
<li>Check Python path configuration</li>
<li>Ensure build process completed without errors</li>
</ul>
<h3><a class="anchor" id="autotoc_md247"></a>
2. Shared Memory Permission Errors</h3>
<div class="fragment"><div class="line">Permission denied</div>
</div><!-- fragment --><p> <b>Solution:</b></p><ul>
<li>Check execution permissions</li>
<li>Run with sudo if necessary (not recommended for production)</li>
<li>Verify user group memberships</li>
</ul>
<h3><a class="anchor" id="autotoc_md248"></a>
3. Data Inconsistency</h3>
<p><b>Symptoms:</b> Retrieved data doesn't match published data <b>Solution:</b></p><ul>
<li>Add appropriate sleep/wait times between operations</li>
<li>Verify buffer sizes are adequate</li>
<li>Check for race conditions in multi-threaded code</li>
</ul>
<h2><a class="anchor" id="autotoc_md249"></a>
Debug Methods</h2>
<h3><a class="anchor" id="autotoc_md250"></a>
1. System Log Analysis</h3>
<div class="fragment"><div class="line"># Check system logs for error messages</div>
<div class="line">tail -f /var/log/syslog | grep shm</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md251"></a>
2. Shared Memory Inspection</h3>
<div class="fragment"><div class="line"># Check shared memory segments</div>
<div class="line">ipcs -m</div>
<div class="line"> </div>
<div class="line"># Remove specific shared memory segment if needed</div>
<div class="line">ipcrm -m &lt;shmid&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md252"></a>
3. Process Communication Verification</h3>
<div class="fragment"><div class="line"># Test publisher/subscriber independently</div>
<div class="line">import shm_pub_sub</div>
<div class="line"> </div>
<div class="line"># Test publisher only</div>
<div class="line">pub = shm_pub_sub.Publisher(&quot;test_topic&quot;, 0, 3)</div>
<div class="line">for i in range(10):</div>
<div class="line">    pub.publish(i)</div>
<div class="line">    print(f&quot;Published: {i}&quot;)</div>
<div class="line"> </div>
<div class="line"># Test subscriber only (run in separate process)</div>
<div class="line">sub = shm_pub_sub.Subscriber(&quot;test_topic&quot;, 0)</div>
<div class="line">for i in range(10):</div>
<div class="line">    data, success = sub.subscribe()</div>
<div class="line">    print(f&quot;Received: {data}, Success: {success}&quot;)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md253"></a>
🎯 Real-World Applications</h1>
<h2><a class="anchor" id="autotoc_md254"></a>
1. Robot Sensor Network</h2>
<div class="fragment"><div class="line">import shm_pub_sub</div>
<div class="line">import time</div>
<div class="line">import random</div>
<div class="line">import threading</div>
<div class="line"> </div>
<div class="line">class RobotSensorNetwork:</div>
<div class="line">    def __init__(self):</div>
<div class="line">        # Create publishers for different sensors</div>
<div class="line">        self.lidar_pub = shm_pub_sub.Publisher(&quot;lidar_distance&quot;, 0.0, 5)</div>
<div class="line">        self.camera_pub = shm_pub_sub.Publisher(&quot;camera_fps&quot;, 0.0, 3)</div>
<div class="line">        self.imu_pub = shm_pub_sub.Publisher(&quot;imu_acceleration&quot;, 0.0, 10)</div>
<div class="line">        </div>
<div class="line">        # Create control system subscriber</div>
<div class="line">        self.control_sub = shm_pub_sub.Subscriber(&quot;control_command&quot;, 0)</div>
<div class="line">        </div>
<div class="line">    def simulate_lidar(self):</div>
<div class="line">        &quot;&quot;&quot;Simulate LIDAR sensor readings&quot;&quot;&quot;</div>
<div class="line">        while True:</div>
<div class="line">            distance = random.uniform(0.1, 10.0)  # 10cm to 10m range</div>
<div class="line">            self.lidar_pub.publish(distance)</div>
<div class="line">            time.sleep(0.1)  # 10Hz</div>
<div class="line">    </div>
<div class="line">    def simulate_camera(self):</div>
<div class="line">        &quot;&quot;&quot;Simulate camera frame rate monitoring&quot;&quot;&quot;</div>
<div class="line">        while True:</div>
<div class="line">            fps = random.uniform(25.0, 35.0)  # 25-35 FPS</div>
<div class="line">            self.camera_pub.publish(fps)</div>
<div class="line">            time.sleep(0.033)  # ~30Hz</div>
<div class="line">    </div>
<div class="line">    def simulate_imu(self):</div>
<div class="line">        &quot;&quot;&quot;Simulate IMU acceleration readings&quot;&quot;&quot;</div>
<div class="line">        while True:</div>
<div class="line">            acceleration = random.uniform(-2.0, 2.0)  # ±2g</div>
<div class="line">            self.imu_pub.publish(acceleration)</div>
<div class="line">            time.sleep(0.01)  # 100Hz</div>
<div class="line">    </div>
<div class="line">    def start_sensors(self):</div>
<div class="line">        &quot;&quot;&quot;Start all sensor simulation threads&quot;&quot;&quot;</div>
<div class="line">        sensors = [</div>
<div class="line">            threading.Thread(target=self.simulate_lidar),</div>
<div class="line">            threading.Thread(target=self.simulate_camera),</div>
<div class="line">            threading.Thread(target=self.simulate_imu)</div>
<div class="line">        ]</div>
<div class="line">        </div>
<div class="line">        for sensor in sensors:</div>
<div class="line">            sensor.daemon = True</div>
<div class="line">            sensor.start()</div>
<div class="line">        </div>
<div class="line">        return sensors</div>
<div class="line"> </div>
<div class="line"># Usage</div>
<div class="line">robot = RobotSensorNetwork()</div>
<div class="line">sensor_threads = robot.start_sensors()</div>
<div class="line"> </div>
<div class="line"># Keep main thread alive</div>
<div class="line">for thread in sensor_threads:</div>
<div class="line">    thread.join()</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md255"></a>
2. Real-Time Data Analytics</h2>
<div class="fragment"><div class="line">import shm_pub_sub</div>
<div class="line">import time</div>
<div class="line">import statistics</div>
<div class="line">import threading</div>
<div class="line">from collections import deque</div>
<div class="line"> </div>
<div class="line">class DataAnalytics:</div>
<div class="line">    def __init__(self):</div>
<div class="line">        self.data_buffer = deque(maxlen=100)</div>
<div class="line">        self.analytics_pub = shm_pub_sub.Publisher(&quot;analytics_result&quot;, 0.0, 5)</div>
<div class="line">        self.data_sub = shm_pub_sub.Subscriber(&quot;sensor_data&quot;, 0.0)</div>
<div class="line">        </div>
<div class="line">    def collect_data(self):</div>
<div class="line">        &quot;&quot;&quot;Continuously collect sensor data&quot;&quot;&quot;</div>
<div class="line">        while True:</div>
<div class="line">            data, success = self.data_sub.subscribe()</div>
<div class="line">            if success:</div>
<div class="line">                self.data_buffer.append(data)</div>
<div class="line">            time.sleep(0.01)</div>
<div class="line">    </div>
<div class="line">    def analyze_data(self):</div>
<div class="line">        &quot;&quot;&quot;Perform real-time analytics&quot;&quot;&quot;</div>
<div class="line">        while True:</div>
<div class="line">            if len(self.data_buffer) &gt;= 10:</div>
<div class="line">                # Calculate moving average</div>
<div class="line">                recent_data = list(self.data_buffer)[-10:]</div>
<div class="line">                moving_avg = statistics.mean(recent_data)</div>
<div class="line">                </div>
<div class="line">                # Publish analytics result</div>
<div class="line">                self.analytics_pub.publish(moving_avg)</div>
<div class="line">                </div>
<div class="line">                print(f&quot;📊 Analytics: Moving average = {moving_avg:.3f}&quot;)</div>
<div class="line">            </div>
<div class="line">            time.sleep(0.1)</div>
<div class="line">    </div>
<div class="line">    def start_analytics(self):</div>
<div class="line">        &quot;&quot;&quot;Start analytics threads&quot;&quot;&quot;</div>
<div class="line">        threads = [</div>
<div class="line">            threading.Thread(target=self.collect_data),</div>
<div class="line">            threading.Thread(target=self.analyze_data)</div>
<div class="line">        ]</div>
<div class="line">        </div>
<div class="line">        for thread in threads:</div>
<div class="line">            thread.daemon = True</div>
<div class="line">            thread.start()</div>
<div class="line">        </div>
<div class="line">        return threads</div>
<div class="line"> </div>
<div class="line"># Usage</div>
<div class="line">analytics = DataAnalytics()</div>
<div class="line">analytics_threads = analytics.start_analytics()</div>
<div class="line"> </div>
<div class="line"># Keep running</div>
<div class="line">for thread in analytics_threads:</div>
<div class="line">    thread.join()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md256"></a>
🔗 Related Documentation</h1>
<h2><a class="anchor" id="autotoc_md257"></a>
Core Documentation</h2>
<ul>
<li><b><a class="el" href="md_manual_introduction_en.html">🚀 Introduction to SHM</a></b> - Fundamental concepts and overview</li>
<li><b><a class="el" href="md_manual_tutorials_en.html">📝 C++ Tutorials</a></b> - Complete C++ API documentation</li>
<li><b><a class="el" href="md_manual_tutorials_shm_pub_sub_en.html">🔄 Publisher/Subscriber Model</a></b> - Advanced Pub/Sub patterns</li>
</ul>
<h2><a class="anchor" id="autotoc_md258"></a>
Python-Specific Guides</h2>
<ul>
<li><b><a class="el" href="md_manual_tutorials_shm_pub_sub_python_en.html">📖 Python Pub/Sub Examples</a></b> - Detailed Python examples</li>
<li><b><a class="el" href="md_manual_spec_en.html">🐍 Python API Reference</a></b> - Complete API specification</li>
</ul>
<h2><a class="anchor" id="autotoc_md259"></a>
Advanced Topics</h2>
<ul>
<li><b><a class="el" href="md_manual_tutorials_shm_service_en.html">🤝 Service Communication</a></b> - Request-response patterns</li>
<li><b><a class="el" href="md_manual_tutorials_shm_action_en.html">⚡ Action Communication</a></b> - Asynchronous task management</li>
</ul>
<h1><a class="anchor" id="autotoc_md260"></a>
💡 Best Practices</h1>
<h2><a class="anchor" id="autotoc_md261"></a>
Design Patterns</h2>
<ol type="1">
<li><b>Topic Naming Conventions</b> <div class="fragment"><div class="line"># Good - descriptive and hierarchical</div>
<div class="line">pub = shm_pub_sub.Publisher(&quot;robot/sensors/lidar/distance&quot;, 0.0, 5)</div>
<div class="line"> </div>
<div class="line"># Better - include units and context</div>
<div class="line">pub = shm_pub_sub.Publisher(&quot;robot_main/lidar_front/distance_meters&quot;, 0.0, 5)</div>
</div><!-- fragment --></li>
<li><b>Error Handling</b> <div class="fragment"><div class="line">def robust_subscriber():</div>
<div class="line">    sub = shm_pub_sub.Subscriber(&quot;data_topic&quot;, 0.0)</div>
<div class="line">    </div>
<div class="line">    while True:</div>
<div class="line">        try:</div>
<div class="line">            data, success = sub.subscribe()</div>
<div class="line">            if success:</div>
<div class="line">                process_data(data)</div>
<div class="line">            else:</div>
<div class="line">                # Handle no-data case gracefully</div>
<div class="line">                time.sleep(0.01)</div>
<div class="line">        except Exception as e:</div>
<div class="line">            print(f&quot;❌ Error in subscriber: {e}&quot;)</div>
<div class="line">            time.sleep(0.1)  # Brief pause before retry</div>
</div><!-- fragment --></li>
<li><b>Resource Management</b> <div class="fragment"><div class="line">class ManagedPublisher:</div>
<div class="line">    def __init__(self, topic, default_value, buffer_num=3):</div>
<div class="line">        self.pub = shm_pub_sub.Publisher(topic, default_value, buffer_num)</div>
<div class="line">        </div>
<div class="line">    def __enter__(self):</div>
<div class="line">        return self.pub</div>
<div class="line">        </div>
<div class="line">    def __exit__(self, exc_type, exc_val, exc_tb):</div>
<div class="line">        # Cleanup if needed</div>
<div class="line">        pass</div>
<div class="line"> </div>
<div class="line"># Usage</div>
<div class="line">with ManagedPublisher(&quot;my_topic&quot;, 0.0) as pub:</div>
<div class="line">    pub.publish(42.0)</div>
</div><!-- fragment --></li>
</ol>
<hr  />
<p><b>🎉 Congratulations!</b> You've mastered Python inter-process communication with shared memory! Start building lightning-fast, distributed Python applications! 🚀✨ </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jul 6 2025 00:08:41 for SHM by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
